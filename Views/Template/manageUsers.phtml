<h5>Create new user</h5>
<form action="<?= $_SERVER["PHP_SELF"] ?>?tab=<?= $page ?>" method="post">
    <div class="form-group">
        <label for="username">Username:</label>
        <input type="text" id="username" class="form-control" name="username" placeholder="Please enter your user name">
    </div>
    <div class="form-group">
        <label for="password">Password:</label>
        <input type="password" id="password" class="form-control" name="password" placeholder="Enter password">
    </div>
    <div class="form-group">
        <label for="confirm_password">Confirm Password:</label>
        <input type="password" id="confirm_password" class="form-control" name="confirm_password" placeholder="Confirm password">
    </div>
    <div class="form-group">
        <button class="btn btn-success" type="submit" name="addUser">Create User</button>
    </div>
</form>
<!-- on submit insert role value into user through the db -->

<h5>Current Users</h5>

<table class="table table-striped table-sm">
    <caption>List of users</caption>
    <thead class="thead-dark">
    <tr>
        <th scope="col">#</th>
        <th scope="col">Username</th>
        <th scope="col">Roles</th>
        <th scope="col">Groups</th>
        <th scope="col">Manage</th>
    </tr>
    </thead>
    <tbody id="users">
    <?php $editID = $_GET["e-id"] ?? null; ?>
    <?php foreach (User::getAllusers() as $index => $user) : ?>
        <?php if ($editID && $editID == $user->id() && $user != Authentication::User()) : ?>
        <tr>
            <th scope="row"><?= $index+1?></th>
            <td class="u-name">
                <input type="text" id="new-username" class="form-control" name="username" value="<?= $user->username()?>" placeholder="<?= $user->username()?>">
            </td>
            <td class="roles">
                <select name="role" id="new-role" class="role-select form-control">
                    <?php foreach (Role::allRoles() as $role) : ?>
                        <option value="<?= $role->id ?>" <?= $role->id == $user->role()->id ? "selected class='selected'" : "" ?>><?= $role->role_name?> <?= $role->id == $user->role()->id ? " (current) " : "" ?></option>
                    <?php endforeach; ?>
                </select>
            </td>
            <td class="groups">
                <p class="m-0 new-group"><i class="fas fa-plus-square mr-2 text-success"></i>Add a new group...</p>
                <div class="new-group">

                </div>
            </td>
            <td class="buttons">
                <button class="ml-auto btn btn-sm btn-dark del-btn" id="save">Save</button>
            </td>
        </tr>
        <form action="#" method="post" id="change">

        </form>
        <?php else : ?>
        <tr id="show-<?= $user->id() ?>" class="table-row show">
            <th scope="row"><?= $index+1?></th>
            <td class="u-name">
                <span>
                    <?= $user->username() ?>
                    <strong><?= $user == Authentication::User() ? " (you) " : "" ?></strong>
                </span>
            </td>
            <td class="roles">
                <span><?= $user->role()->role_name ?></span>
            </td>
            <td class="groups">
                <?php foreach ($user->teams() as $team) : ?>
                    <span><?= $team ?>, </span>
                <?php endforeach; ?>
            </td>
            <td class="buttons">
                <?php if ($user != Authentication::User()) : ?>
                    <a href="<?= $_SERVER["PHP_SELF"]?>?tab=manageUsers&e-id=<?= $user->id() ?>#users" class="ml-auto btn btn-sm btn-success edit-btn" id="<?= $user->id() ?>">Edit</a>
                    <button class="ml-auto btn btn-sm btn-danger del-btn" id="del-<?= $user->id() ?>">Delete</button>
                <?php else : ?>
                    <button class="ml-auto btn btn-sm btn-success" disabled>Edit</button>
                    <button class="ml-auto btn btn-sm btn-danger" disabled>Delete</button>
                <?php endif; ?>
            </td>
        </tr>
        <?php endif; ?>
    <?php endforeach; ?>
    </tbody>
</table>

<script>

</script>
